<script>
  const totalSheets = 15; // ‚Üê just change this number!
  const tabBar = document.getElementById('tabBar');
  const sheetsContainer = document.getElementById('sheets');

  for (let i = 1; i <= totalSheets; i++) {
    const tab = document.createElement('button');
    tab.className = 'tab-button';
    tab.textContent = `Sheet ${i}`;
    tab.dataset.sheet = `sheet${i}`;
    tab.addEventListener('click', () => switchTab(i));
    tabBar.appendChild(tab);

    const sheet = document.createElement('div');
    sheet.className = 'sheet';
    sheet.id = `sheet${i}`;
    sheetsContainer.appendChild(sheet);
  }

  function switchTab(sheetNum) {
    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.sheet').forEach(sheet => sheet.classList.remove('active'));

    document.querySelector(`.tab-button:nth-child(${sheetNum})`).classList.add('active');
    const sheetDiv = document.getElementById(`sheet${sheetNum}`);
    sheetDiv.classList.add('active');

    fetch(`sheet${sheetNum}.md`)
      .then(response => {
        if (!response.ok) throw new Error("File not found");
        return response.text();
      })
      .then(md => {
        sheetDiv.innerHTML = marked.parse(md);
      })
      .catch(err => {
        sheetDiv.innerHTML = `<p style="color:red;">Error loading sheet${sheetNum}.md</p>`;
      });
  }

  switchTab(1);
</script>
